# Module Standards

This document outlines the standards and conventions for developing Terraform Azure modules in this repository.

## File Structure

All modules must follow this standard structure:

```
terraform-azurerm-<service>/
├── main.tf           # Primary resource definitions
├── variables.tf      # Input variables
├── outputs.tf        # Output values
├── locals.tf         # Local values and computations
├── provider.tf       # Provider requirements
└── README.md         # Module documentation
```

## Naming Conventions

### Module Names
- Format: `terraform-azurerm-<service-name>`
- Use lowercase with hyphens
- Examples: `terraform-azurerm-storage-account`, `terraform-azurerm-virtual-network`

### Resource Names
- Use the standard naming convention: `<region>-<environment>-<platform>-<purpose>-<resource_type>-<instance>`
- Implement via locals.tf for consistency

### Variables
- Use descriptive names
- Include type definitions
- Add validation where appropriate
- Provide meaningful descriptions

## Provider Requirements

### Current Standard
```hcl
terraform {
  required_providers {
    azurerm = {
      source  = "hashicorp/azurerm"
      version = "~> 3.116.0"
    }
  }
}
```

### Version Policy
- Always use the latest stable version
- Use pessimistic version constraints (`~>`)
- Update quarterly or when security patches are released

## Resource Standards

### Tags
- All resources must support tagging
- Use consistent tag structure across modules
- Default tags should be configurable via variables

### Security
- Enable encryption by default where applicable
- Follow Azure security best practices
- Implement least privilege access

### Lifecycle Management
- Use lifecycle blocks to prevent accidental deletion
- Ignore changes for auto-generated tags

## Documentation Requirements

### README.md
Each module must include:
- Description and purpose
- Usage examples
- Input/output tables (generated by terraform-docs)
- Requirements section
- Provider version requirements

### Comments
- Document complex logic in main.tf
- Explain non-obvious variable validations
- Include references to Azure documentation where relevant

## Testing

### Validation
- All modules must pass `terraform validate`
- Use `terraform fmt` for consistent formatting
- Implement variable validation where appropriate

### Examples
- Provide working examples in module README
- Test examples in development environment
- Keep examples up to date

## Versioning

### Git Tags
- Use semantic versioning (v1.0.0, v1.1.0, etc.)
- Tag releases for version tracking
- Maintain changelog for major changes

### Breaking Changes
- Document breaking changes clearly
- Provide migration guides
- Follow semantic versioning for major version bumps
